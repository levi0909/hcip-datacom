# 01_路由协议介绍

[TOC]

### 1.路由协议的作用

#### 1.1.什么是路由协议？

路由协议的存在是为了**传递、生成路由条目**，并将路由条目保存在网络设备的路由表中。所以，三层通信的本质是**查表转发**，表指的就是路由表。那现在我们就要建立一个非常非常重要的观点：**如果，只考虑网络通信问题，那么一个网段到另一个网段无法通信，一定是因为数据包经过的某个网络设备上缺失（不正确）了目的网段的路由条目。但是，一定要考虑数据通信是一个双向的过程，有来也有回。**

综上所述，无论是多高级的路由协议，都是为了实现**端到端通信**的。路由协议就是服务于数据包的，好比是铺路搭桥，有了路车马才能同行。

![image-20250804223711349](https://gitee.com/chouhama/pic/raw/master/20250804223815110.png)

------

**举个例子：**

假设现在，小明要从上海市普陀区真如街道的A小区寄一个包裹到北京市朝阳区三里屯街道B小区的小周，整个过程是什么样的呢？

1. 包裹从小明所在的A小区送到真如街道的快递驿站。
2. 真如街道的快递驿站送到普陀区快递中转中心。
3. 普陀区中转中心送到上海市集散中心。
4. 上海市集散中心送到北京集散中心（中间经过了江苏、安徽、山东）
5. 北京集散中心送到朝阳区快递中转中心。
6. 朝阳区快递中转中心送到三里屯街道快递驿站。
7. 三里屯快递驿站送到B小区的小周。

![image-20250804225153877](https://gitee.com/chouhama/pic/raw/master/20250804225153939.png)

**问题1：**

1. 小明/小周与街道的快递驿站属于**二层通信还是三层通信？**

2. 在整个寄包裹的过程中，寄件人和收件人的地址会不会变**（源目IP地址）？**
3. 在整个寄包裹的过程中，货车的实际下一跳**（目MAC地址）**会不会变？
4. 在**数据通信**的过程中，是怎么有效区别出**源端点、目的端点与下一跳**？
   1. 换句话说，这里指的**实际下一跳**，是为了告诉**数据包**你的下一个节点是哪里。那是不是就说明**下一跳**是实际指导数据包转发的有效信息。只有下一跳存在、正确且连贯，端点之间的通信才能成功。
   2. 那这个**下一跳**怎么生成的呢？==路由协议==。

------

**问题2：**

假设，快递在运送的过程中，江苏因为刮台风原定的道路无法继续前进了。那么，我们的快递还能不能重新送达呢？

![image-20250804232110255](https://gitee.com/chouhama/pic/raw/master/20250804232110327.png)

这个问题当然可以解决，快递车只要绕道，从其他不刮台风的省市到目的地北京就解决了。这就是**路由冗余**。

![image-20250804232221246](https://gitee.com/chouhama/pic/raw/master/20250804232221315.png)

但是还有一个问题，假设司机师傅不会用导航，并且对路况不太熟悉，他只知道原定的路线怎么走，并不知道绕路应该怎么走，那咋办呢？

- 这种情况，就是使用**静态路由协议**的特点，所有的路由都是通过人为手工指定的，并不会根据当前网络中的不同情况发生改变。
- 导航就类似于**动态路由协议**，会根据当前网络中不同的情况发生改变。比如：
  - 有更优选的路径出现，实时转换。
  - 原路径故障，切换备份路径。
- 难道**动态路由**就是万能的么？当然不是，如果每条路都走不通，或者有环路情况发生，那动态路由也就束手无策了。

------

#### 1.2.路由协议的分类

![image-20250805161525715](https://gitee.com/chouhama/pic/raw/master/20250805161532837.png)

- **静态路由：**手动配置，网络拓扑发生变化后需要手工调整，资源占用低，适合小型场景。

- **动态路由：**自动学习路由，自适应拓扑变化，资源占用较高，适合中大型场景。

  - **内部网关协议（IGP）：**用于**同一自治系统（AS）内部**的路由协议

    - **距离矢量路由协议：**
      - **RIP（Routing Information Protocol）：**居于距离向量算法，跳数限制为15。

    - **链路状态路由协议：**
      - **OSPF（Open Shortest Path First）：**基于链路状态算法，支持分层设计，适合中大型网络。
      - **IS-IS（Intermediate System to Intermediate System）：**类似`OSPF`的链路状态协议，常用于运营商网络。
    - **融合版：**
      - **EIGRP：**`Cisco`私有协议，结合距离矢量和链路状态特性。

  - **外部网关协议（EGP）：**用于**不同自治系统（AS）之间**的路由协议

    - **BGP（Border Gateway Protocol）：**当前互联网核心路由协议，基于距离矢量算法，支持复杂的路由策略。

------

#### 1.3.动态路由协议的作用

动态路由协议的核心作用是**在网络中自动发现、计算和维护最优路径**，确保数据包能够高效、可靠地从源设备传输到目标设备。

- **路径发现与计算**

  - **动态学习路由：**通过交换路由信息，自动发现网络拓扑。

  - **计算最优路径：**基于特定算法选择最佳路由。
    - `OSPF/IS-IS`：基于链路状态（带宽、延迟）计算最短路径。
    - `BGP`：基于策略（`AS_PATH`、本地优先级）选择路径。

- **网络收敛与容错**

  - **快速适应拓扑变化：**当链路故障时，重新计算路径。

  - **冗余备份：**自动启用备用路径。

- **避免路由环路**

------

